<!DOCTYPE html>
<html>
<head>
<title>c-base - Unauthoritative member statistics</title>
<script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
<script src="//code.highcharts.com/highcharts.js"></script>
<script src="//code.highcharts.com/modules/data.js"></script>
<script src="//code.highcharts.com/modules/exporting.js"></script>

<!-- Additional files for the Highslide popup effect -->
<!--<script type="text/javascript" src="//www.highcharts.com/media/com_demo/highslide-full.min.js"></script>
<script type="text/javascript" src="//www.highcharts.com/media/com_demo/highslide.config.js" charset="utf-8"></script>
<link rel="stylesheet" type="text/css" href="//www.highcharts.com/media/com_demo/highslide.css" />
-->

<div id="container" style="min-width: 310px; height: 400px; margin: 0 auto"></div>

<script type="text/javascript">
$(document).ready(function() {
  /*
  var username = window.prompt("c-base username?");
  var password = window.prompt("c-base password?");
  */
  var options = {
    title: {
      text: 'c-base members'
    },
    subtitle: {
      text: 'Unauthoritative statistics'
    },
    xAxis: {
      gridLineWidth: 1,
      type: 'datetime'
    },
    yAxis: {
      gridLineWidth: 1,
      min: 0
    },
    chart: {
      renderTo: 'container',
      type: 'spline'
    },
    tooltip: {
      formatter: function() {
        return Highcharts.dateFormat("%b %Y", this.x, true)+':  '+ this.y + ' Members';
      }
    },
    series: [{name: 'Members'}]
  };

  $.ajax({
    dataType: "json",
    url: 'https://vorstand.c-base.org/cteward-api/legacy/stats/members?callback=?',
    /*
    beforeSend: function setAuthHeader(xhr) {
      var creds = username + ':' + password;
      var basicScheme = btoa(creds);
      var hashStr = "Basic "+basicScheme;
      xhr.setRequestHeader('Authorization', hashStr);
    },
    */
    success: function(data) {
      var series = [];
      for (var i=0; i < data.length; i++) {
        series.push([ Date.parse(String(data[i].Year)+"-"+String(data[i].Month)+"-28"), data[i].Members]);
      }
      options.series[0].data = series;
      var chart = new Highcharts.Chart(options);
    }
    });
});
</script>

